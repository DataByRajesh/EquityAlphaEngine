2025-09-11 17:42:53,016 - INFO - compute_factors called for DataFrame with 3 rows
2025-09-11 17:42:53,053 - WARNING - Failed to compute amihud_illiquidity: Cannot set a DataFrame with multiple columns to the single column amihud_illiquidity
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 260, in compute_factors
    df["amihud_illiquidity"] = (
    ~~^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4306, in __setitem__
    self._set_item_frame_value(key, value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4464, in _set_item_frame_value
    raise ValueError(
    ...<2 lines>...
    )
ValueError: Cannot set a DataFrame with multiple columns to the single column amihud_illiquidity
2025-09-11 17:42:53,067 - INFO - Factor computation complete for 3 rows.
2025-09-11 17:43:48,307 - INFO - compute_factors called for DataFrame with 3 rows
2025-09-11 17:43:48,342 - WARNING - Failed to compute amihud_illiquidity: Cannot set a DataFrame with multiple columns to the single column amihud_illiquidity
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 264, in compute_factors
    df["amihud_illiquidity"] = amihud_series
    ~~^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4306, in __setitem__
    self._set_item_frame_value(key, value)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4464, in _set_item_frame_value
    raise ValueError(
    ...<2 lines>...
    )
ValueError: Cannot set a DataFrame with multiple columns to the single column amihud_illiquidity
2025-09-11 17:43:48,356 - INFO - Factor computation complete for 3 rows.
2025-09-11 17:44:17,137 - INFO - compute_factors called for DataFrame with 3 rows
2025-09-11 17:44:17,177 - INFO - Factor computation complete for 3 rows.
2025-09-11 17:44:41,601 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:44:41,644 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:44:41,654 - INFO - compute_factors called for DataFrame with 1 rows
2025-09-11 17:44:41,691 - INFO - Factor computation complete for 1 rows.
2025-09-11 17:44:42,035 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:44:42,037 - WARNING - Failed to compute return_1m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,040 - WARNING - Failed to compute return_3m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,041 - WARNING - Failed to compute return_6m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,041 - WARNING - Failed to compute return_12m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,042 - WARNING - Failed to compute momentum_12_1: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 66, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,043 - WARNING - Failed to compute vol_21d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,043 - WARNING - Failed to compute vol_63d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,044 - WARNING - Failed to compute vol_252d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,045 - WARNING - Failed to compute ma_20: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,045 - WARNING - Failed to compute ma_50: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,046 - WARNING - Failed to compute ma_200: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,047 - WARNING - Failed to compute RSI_14: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 115, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,047 - WARNING - Failed to compute MACD/MACDh: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 144, in compute_factors
    macd_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,048 - WARNING - Failed to compute Bollinger Bands: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 174, in compute_factors
    bb_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,056 - WARNING - Failed to compute amihud_illiquidity: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 243, in compute_factors
    returns_abs = df.groupby("Ticker")["close_price"].transform(
                  ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,062 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:44:42,072 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:44:42,073 - WARNING - Failed to compute return_1m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,074 - WARNING - Failed to compute return_3m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,075 - WARNING - Failed to compute return_6m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,075 - WARNING - Failed to compute return_12m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,076 - WARNING - Failed to compute momentum_12_1: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 66, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,077 - WARNING - Failed to compute vol_21d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,077 - WARNING - Failed to compute vol_63d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,078 - WARNING - Failed to compute vol_252d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,078 - WARNING - Failed to compute ma_20: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,079 - WARNING - Failed to compute ma_50: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,080 - WARNING - Failed to compute ma_200: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,080 - WARNING - Failed to compute RSI_14: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 115, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,081 - WARNING - Failed to compute MACD/MACDh: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 144, in compute_factors
    macd_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,082 - WARNING - Failed to compute Bollinger Bands: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 174, in compute_factors
    bb_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,088 - WARNING - Failed to compute amihud_illiquidity: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 243, in compute_factors
    returns_abs = df.groupby("Ticker")["close_price"].transform(
                  ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,095 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:44:42,126 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 17:44:42,128 - WARNING - Failed to compute return_1m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,129 - WARNING - Failed to compute return_3m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,129 - WARNING - Failed to compute return_6m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,130 - WARNING - Failed to compute return_12m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,131 - WARNING - Failed to compute momentum_12_1: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 66, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,131 - WARNING - Failed to compute vol_21d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,132 - WARNING - Failed to compute vol_63d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,132 - WARNING - Failed to compute vol_252d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,133 - WARNING - Failed to compute ma_20: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,134 - WARNING - Failed to compute ma_50: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,134 - WARNING - Failed to compute ma_200: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,135 - WARNING - Failed to compute RSI_14: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 115, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,135 - WARNING - Failed to compute MACD/MACDh: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 144, in compute_factors
    macd_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,136 - WARNING - Failed to compute Bollinger Bands: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 174, in compute_factors
    bb_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,138 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:44:42,139 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:44:42,147 - WARNING - Failed to compute amihud_illiquidity: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 243, in compute_factors
    returns_abs = df.groupby("Ticker")["close_price"].transform(
                  ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,160 - INFO - Factor computation complete for 25 rows.
2025-09-11 17:44:42,415 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 17:44:42,417 - WARNING - Failed to compute return_1m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,418 - WARNING - Failed to compute return_3m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,419 - WARNING - Failed to compute return_6m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,419 - WARNING - Failed to compute return_12m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 55, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,420 - WARNING - Failed to compute momentum_12_1: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 66, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,421 - WARNING - Failed to compute vol_21d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,421 - WARNING - Failed to compute vol_63d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,422 - WARNING - Failed to compute vol_252d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 84, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,423 - WARNING - Failed to compute ma_20: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,423 - WARNING - Failed to compute ma_50: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,424 - WARNING - Failed to compute ma_200: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 102, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,425 - WARNING - Failed to compute RSI_14: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 115, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,425 - WARNING - Failed to compute MACD/MACDh: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 144, in compute_factors
    macd_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,426 - WARNING - Failed to compute Bollinger Bands: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 174, in compute_factors
    bb_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,428 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:44:42,429 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:44:42,434 - WARNING - Failed to compute amihud_illiquidity: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 243, in compute_factors
    returns_abs = df.groupby("Ticker")["close_price"].transform(
                  ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:44:42,440 - INFO - Factor computation complete for 2 rows.
2025-09-11 17:46:18,440 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 17:46:18,441 - WARNING - Failed to compute return_1m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 56, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,443 - WARNING - Failed to compute return_3m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 56, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,444 - WARNING - Failed to compute return_6m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 56, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,445 - WARNING - Failed to compute return_12m: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 56, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,445 - WARNING - Failed to compute momentum_12_1: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 67, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,446 - WARNING - Failed to compute vol_21d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 85, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,447 - WARNING - Failed to compute vol_63d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 85, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,447 - WARNING - Failed to compute vol_252d: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 85, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,448 - WARNING - Failed to compute ma_20: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 103, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,449 - WARNING - Failed to compute ma_50: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 103, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,449 - WARNING - Failed to compute ma_200: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 103, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,450 - WARNING - Failed to compute RSI_14: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 116, in compute_factors
    df.groupby("Ticker")["close_price"]
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,451 - WARNING - Failed to compute MACD/MACDh: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 145, in compute_factors
    macd_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,451 - WARNING - Failed to compute Bollinger Bands: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 175, in compute_factors
    bb_df = df.groupby("Ticker", group_keys=False)["close_price"].apply(
            ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,453 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:46:18,454 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:46:18,463 - WARNING - Failed to compute amihud_illiquidity: 'Column not found: close_price'
Traceback (most recent call last):
  File "/workspace/data_pipeline/compute_factors.py", line 244, in compute_factors
    returns_abs = df.groupby("Ticker")["close_price"].transform(
                  ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/groupby/generic.py", line 1951, in __getitem__
    return super().__getitem__(key)
           ~~~~~~~~~~~~~~~~~~~^^^^^
  File "/workspace/.venv/lib/python3.13/site-packages/pandas/core/base.py", line 245, in __getitem__
    raise KeyError(f"Column not found: {key}")
KeyError: 'Column not found: close_price'
2025-09-11 17:46:18,476 - INFO - Factor computation complete for 25 rows.
2025-09-11 17:47:03,222 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 17:47:03,224 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:47:03,241 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:47:03,241 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:47:03,260 - INFO - Factor computation complete for 25 rows.
2025-09-11 17:47:48,160 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 17:47:48,162 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:47:48,187 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:47:48,187 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:47:48,216 - INFO - Factor computation complete for 25 rows.
2025-09-11 17:47:57,515 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:47:57,555 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:47:57,564 - INFO - compute_factors called for DataFrame with 1 rows
2025-09-11 17:47:57,600 - INFO - Factor computation complete for 1 rows.
2025-09-11 17:47:57,939 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:47:57,940 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:47:57,971 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:47:57,978 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:47:57,980 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:47:58,013 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:49:02,068 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 17:49:02,074 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:49:02,109 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:49:02,109 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:49:02,142 - INFO - Factor computation complete for 25 rows.
2025-09-11 17:49:02,232 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 17:49:02,234 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:49:02,271 - INFO - Factor computation complete for 2 rows.
2025-09-11 17:49:02,339 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:49:02,376 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:49:02,386 - INFO - compute_factors called for DataFrame with 1 rows
2025-09-11 17:49:02,421 - INFO - Factor computation complete for 1 rows.
2025-09-11 17:49:03,536 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:49:03,538 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:49:03,576 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:49:03,585 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:49:03,586 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:49:03,622 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:49:03,663 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 17:49:03,664 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:49:03,689 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:49:03,690 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:49:03,705 - INFO - Factor computation complete for 2 rows.
2025-09-11 17:52:36,218 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 17:52:36,221 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:52:36,248 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:52:36,249 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:52:36,279 - INFO - Factor computation complete for 25 rows.
2025-09-11 17:52:36,300 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 17:52:36,302 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:52:36,338 - INFO - Factor computation complete for 2 rows.
2025-09-11 17:52:36,397 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:52:36,435 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:52:36,445 - INFO - compute_factors called for DataFrame with 1 rows
2025-09-11 17:52:36,481 - INFO - Factor computation complete for 1 rows.
2025-09-11 17:52:36,576 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:52:36,577 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:52:36,615 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:52:36,625 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 17:52:36,626 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:52:36,665 - INFO - Factor computation complete for 4 rows.
2025-09-11 17:52:36,713 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 17:52:36,715 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 17:52:36,740 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 17:52:36,741 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 17:52:36,756 - INFO - Factor computation complete for 2 rows.
2025-09-11 20:02:04,412 - INFO - compute_factors called for DataFrame with 25 rows
2025-09-11 20:02:04,430 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 20:02:04,515 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 20:02:04,519 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 20:02:04,611 - INFO - Factor computation complete for 25 rows.
2025-09-11 20:02:04,690 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 20:02:04,692 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 20:02:04,797 - INFO - Factor computation complete for 2 rows.
2025-09-11 20:02:04,990 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 20:02:05,071 - INFO - Factor computation complete for 4 rows.
2025-09-11 20:02:05,093 - INFO - compute_factors called for DataFrame with 1 rows
2025-09-11 20:02:05,208 - INFO - Factor computation complete for 1 rows.
2025-09-11 20:02:05,488 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 20:02:05,493 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 20:02:05,577 - INFO - Factor computation complete for 4 rows.
2025-09-11 20:02:05,599 - INFO - compute_factors called for DataFrame with 4 rows
2025-09-11 20:02:05,605 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 20:02:05,691 - INFO - Factor computation complete for 4 rows.
2025-09-11 20:02:05,813 - INFO - compute_factors called for DataFrame with 2 rows
2025-09-11 20:02:05,816 - WARNING - Renamed 'Close' to 'close_price' for factor computations
2025-09-11 20:02:05,877 - WARNING - Column 'dividendYield' missing; dividendYield set to NaN.
2025-09-11 20:02:05,877 - WARNING - Column 'priceToSalesTrailing12Months' missing; price_to_sales set to NaN.
2025-09-11 20:02:05,910 - INFO - Factor computation complete for 2 rows.
